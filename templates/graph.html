{% extends "base.html" %}
{% block content %}
    {% if professor_list_list %}
        <div class="container">
        {% if professor_list_list|length%6!=0 %}
            {% set rownumber = (professor_list_list|length/6)|int+1 %}
        {% else %}
            {% set rownumber = (professor_list_list|length/6)|int %}
        {% endif %}
        {% for i in range(rownumber) %}
            <div class="row">
                {% if professor_list_list|length >= 6 %}
                    {% set colnumber = 6 %}
                {% else %}
                    {% set colnumber = professor_list_list|length %}
                {% endif %}
                {% for j in range(colnumber) %}
                    <div class="col">
                        <ul>
                            {% for eachprofessor in professor_list_list.pop(0) %}
                                <li><a href="/graph/professor/{{ eachprofessor }}">{{ eachprofessor }}</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    {% elif cou_dict_list %}
        <div class="container">
            <table class="table table-sm table-hover">
                <thead class="thead-dark">
                <tr>
                    <th scope="col" style="cursor: pointer" onclick='sortForGraph(0,{{ cou_dict_list|tojson }})'>class
                        section
                    </th>
                    <th scope="col" style="cursor: pointer" onclick='sortForGraph(1,{{ cou_dict_list|tojson }})'>class
                        title
                    </th>
                </tr>
                </thead>
                {% for eachdict in cou_dict_list %}
                    <tr>
                        <td>
                            <a href="/graph/course/{{ eachdict.get("class_section") }}"> {{ eachdict.get("class_section") }}</a>
                        </td>
                        <td>{{ eachdict.get("class_title") }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    {% elif professor_name or course_name %}
        <div class="container">
            <div class="row">
                {% if professor_name %}
                    <h2>{{ professor_name }}</h2>
                    {% set datasource=professor_json %}
                {% elif course_name %}
                    <h2>{{ course_name }}</h2>
                    {% set datasource=course_json %}
                {% endif %}
            </div>
            <div class="row">
                <div class="col-md-auto" id="graph" style="width:100%;height:800px;">
                </div>
            </div>
        </div>
        <script type="text/javascript">
            var myChart = echarts.init(document.getElementById('graph'));
            myChart.showLoading();
            datasource = {{ datasource|tojson }};
            myChart.hideLoading();

            // echarts.util.each(datasourse.children, function (datum, index) {
            //     index % 2 === 0 && (datum.collapsed = true);
            // });

            myChart.setOption(option = {
                tooltip: {
                    trigger: 'item',
                    triggerOn: 'mousemove'
                },
                series: [
                    {
                        type: 'tree',

                        data: [datasource],

                        top: '1%',
                        left: '9%',
                        bottom: '1%',
                        right: '30%',

                        symbolSize: 7,

                        label: {
                            normal: {
                                position: 'left',
                                verticalAlign: 'middle',
                                align: 'right',
                                fontSize: 12
                            }
                        },

                        leaves: {
                            label: {
                                normal: {
                                    position: 'right',
                                    verticalAlign: 'middle',
                                    align: 'left'
                                }
                            }
                        },

                        expandAndCollapse: true,
                        animationDuration: 550,
                        animationDurationUpdate: 750
                    }
                ]
            });
            myChart.on('click', function (params) {
                {% if professor_name %}
                    if (params.value)
                        window.open('/graph/course/CS ' + encodeURIComponent(params.value));
                {% elif course_name %}
                    if (params.value)
                        window.open('/graph/professor/' + encodeURIComponent(params.value));
                {% endif %}
            });
        </script>
    {% endif %}
{% endblock %}